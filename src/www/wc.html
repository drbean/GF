<!DOCTYPE html>
<html> <head>
<title>Demo: GF Wide Coverage Translation</title>
<link rel="stylesheet" type="text/css" href="gfse/editor.css" title="Cloud">
<meta name = "viewport" content = "width = device-width">
<meta charset="UTF-8">
<link rel=top href="../" title="GF">
<style>
div.center { text-align: center; }
table.center { margin-left: auto; margin-right: auto; }
textarea { margin: 0; }
body:target h1, body:target div.modtime { display: none; }
#extra { color: #666; }
#pick span { padding: 0 0.5ex; }
</style>
</head>

<body id=embed>
<div class=center>
<h1><a href="http://www.grammaticalframework.org/"><img class=nofloat src="P/gf-cloud.png" alt="GF"></a> Wide Coverage Translation</h1>
</div>

<table class="center">
<tr><td>
<form onsubmit="return wc.translate()">
  <textarea name=input rows=3 style="width: 100%"></textarea>
  <br>
  <big>⤷</big>
  <select name=from>
    <option value=Bul>Bulgarian</option>
    <option value=Chi>Chinese</option>
    <option value=Eng selected>English</option>
    <option value=Fin>Finnish</option>
    <option value=Fre>French</option>
    <option value=Ger>German</option>
    <option value=Hin>Hindi</option>
    <option value=Swe>Swedish</option>
  </select> →
  <button name=translate type=submit><strong><big>Translate</big></strong></button> →
  <select name=to onchange="wc.translate()">
    <option value=Bul>Bulgarian</option>
    <option value=Chi>Chinese</option>
    <option value=Eng>English</option>
    <option value=Fin>Finnish</option>
    <option value=Fre>French</option>
    <option value=Ger>German</option>
    <option value=Hin>Hindi</option>
    <option value=Swe selected>Swedish</option>
  </select>
  <big style="position: relative; top: 1ex">⤵</big>
    <button onclick="wc.swap()">↑↓</button>
  <br>
      <textarea name=output rows=3 style="width: 100%" readonly>
      </textarea>
  <br>
</form>
  
</table>
<div class=center>
  <div id=pick></div>
  <small id=extra></small></div>
<p>
<div class=modtime><small>
<!-- hhmts start -->Last modified: Wed Feb 12 16:23:01 CET 2014 <!-- hhmts end -->
</small></div>
<script src="js/support.js"></script>
<script src="js/gftranslate.js"></script>
<script src="js/localstorage.js"></script>
<script src="gfse/localstorage.js"></script>
<script src="gfse/cloud2.js"></script>
<script>
var wc={}
wc.f=document.forms[0]
wc.e=element("extra")
wc.p=element("pick")
wc.translate=function() {
  var f=wc.f, e=wc.e, p=wc.p
  f.translate.disabled=true
  f.output.value=""
  wc.r=[]
  wc.current=0
  clear(e)
  clear(p)

  function show_error(msg) {
    if(e) e.innerHTML=msg
    else f.output.value="["+msg+"]"
  }
  function show_pick(i) { return function() { show_trans(i); return false; } }
  function show_picks() {
    clear(p)
    for(var i=0;i<wc.r.length;i++) {
      p.appendChild(text(" "))
      var pick=text(i+1) // +"⃝"
      if(i!=wc.current) {
        var pick=node("a",{href:"#"},[pick])
        pick.onclick=pick.onmouseover=show_pick(i)
      }
      p.appendChild(span_class("pick",pick))
    }
  }
  function show_trans(i) {
    var r=wc.r[i]
    f.output.value=r.text
    if(e) e.innerHTML=r.prob+"<br>"+r.tree
    wc.current=i
    if(wc.p && wc.r.length>1) show_picks()
  }

  function trans(text,i) {
    function showit(result) {
      wc.r[i].text=result
      if(wc.current==i) show_trans(i)
else show_picks()
      f.translate.disabled=false
      if(wc.p && i<9) trans(text,i+1)
    }
    function step3(trans) {
      if(trans.length>=1) {
        if(trans[0].error) show_error(trans[0].error)
        else {
          var r=wc.r[i]=trans[0]
          if(e && wc.current==i) e.innerHTML=r.prob+"<br>"+r.tree
          unlextext(r.linearizations[0].text,showit)
        }
      }
      else if(i==0) show_error("Unable to translate")
    }
    gftranslate.translate(text,f.from.value,f.to.value,i,1,step3)
  }
  function step2(text) { trans(text,0) }
  lextext(f.input.value,step2)
  return false;
}

wc.swap=function() {
  var f=wc.f
  f.input.value=f.output.value;
  var from=f.from.value
  f.from.value=f.to.value
  f.to.value=from
  wc.translate()
}
</script>
</body>
</html>
